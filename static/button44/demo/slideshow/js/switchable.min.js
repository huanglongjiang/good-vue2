"use strict";!function(e,t){function n(t){return this.each(function(){new s(e(this),t)})}var s=function(t,n){var a,i=this,o=!0;if(i.el=e(t),a=i.options=e.extend({},s.DEFAULTS,n||{}),i.addClassfnc(),a.visible<a.step&&(a.visible=a.step),i.nav=i.el.find("."+a.navItem),i.main=i.el.find("."+a.mainClass),a.step=Math.max(a.step||1,1),i.len=i.main.size(),i.content=i.el.find("."+a.contentClass),i.mainWidth=i.main.outerWidth(a.includeMargin),i.mainHeight=i.main.outerHeight(a.includeMargin),o=a.step<i.len,"tab"==a.type&&a.navSelectedClass&&i.nav.length>0){var l=-1;i.nav.each(function(t){var n=e(this);n.hasClass(a.navSelectedClass)&&(-1==l?l=t:n.removeClass(a.navSelectedClass))}),l>-1&&(a.defaultPanel=l)}if(a.isPingtung&&(a.width=e(window).width()),a.width&&(i.mainWidth=a.width),i.mainHeight=i.main.outerHeight(a.includeMargin),a.height&&(i.mainHeight=a.height),i.cloneCount=a.visible,a.seamlessLoop&&o){for(var c=[],r=[],p=i.cloneCount,u=0;p>u;u++)c.push(i.main.eq(u).clone().attr("data-switchable-clone",p+u).data("switchable-clone-from",p+u)),r.push(i.main.eq(i.len-(u+1)).clone().attr("data-switchable-clone",i.len+u).data("switchable-clone-from",i.len+u));for(var m=0;p>m;m++)i.content.prepend(r[m]).append(c[m]);i.main=i.el.find("."+a.mainClass)}i.main.each(function(t){e(this).data("switchable-idx",t)});var d=a.defaultPanel;i.last=d,i.current=d,i.isInit=!0,a.seamlessLoop&&o?i.switchTo(d,d+i.cloneCount):i.switchTo(d,d),i.autoInterval=null,i.eventTimer=null,o&&(i.autoPlay(),i.eventBind())};s.VERSION="1.1.0",s.DEFAULTS={type:"tab",direction:"left",contentClass:"ui-switchable-panel-main",mainClass:"ui-switchable-panel",mainSelectedClass:"ui-switchable-panel-selected",navItem:"ui-switchable-item",navSelectedClass:"ui-switchable-selected",prevClass:"ui-switchable-prev",nextClass:"ui-switchable-next",contentPage:"ui-switchable-page",contentPageIsConceal:!1,imgscrollClass:"ui-switchable-imgscroll-img",imgscrollItemClass:"ui-switchable-imgscroll-item",imgscrollDataSrc:"data-src",isAutoPlay:!1,mouseenterStopPlay:!0,playDirection:"next",event:"mouseover",speed:400,delay:150,defaultPanel:0,stayTime:5e3,includeMargin:!1,width:0,height:0,step:1,seamlessLoop:!1,visible:1,easing:"swing",hasSetup:!1,hasArrow:!1,arrowClass:"ui-switchable-arrow",navIframe:"data-iframe",callback:null,onNext:null,onPrev:null},s.prototype.addClassfnc=function(){},s.prototype.eventBind=function(){var t=this,n=t.options;t.nav.each(function(s){var a=e(this);a.on(n.event,function(){e(this);clearInterval(t.autoInterval),0===n.delay?(t.current=s,t.switchTo(s,n.seamlessLoop?s+t.cloneCount:s)):(clearTimeout(t.eventTimer),t.eventTimer=setTimeout(function(){t.current=s,t.switchTo(s,n.seamlessLoop?s+t.cloneCount:s)},n.delay))}).on("mouseleave",function(){clearTimeout(t.eventTimer),n.mouseenterStopPlay||t.autoPlay()})}),t.el.on("mouseenter",function(){n.contentPageIsConceal&&e("."+n.contentPage).show(),n.mouseenterStopPlay&&clearInterval(t.autoInterval)}).on("mouseleave",function(){n.contentPageIsConceal&&e("."+n.contentPage).hide(),n.mouseenterStopPlay&&t.autoPlay()}),t.page()},s.prototype.switchTo=function(e,t){var n=this;n.options;"undefined"==typeof e||"undefined"==typeof t||(n.switchNavTo(e),n.switchMainTo(t))},s.prototype.switchNavTo=function(e){var t=this,n=t.options;t.nav.removeClass(n.navSelectedClass),t.nav.eq(e).addClass(n.navSelectedClass)},s.prototype.switchMainTo=function(t){var n=this,s=n.options;if(n.iframefnc(t),"imgscroll"!=s.type&&(n.main.removeClass(s.mainSelectedClass),n.main.eq(t).addClass(s.mainSelectedClass)),n.isInit||n.last!=t){if(n.switchType(t),null!=s.callback){var a=t,i=n.main.eq(a),o=n.nav.eq(a);s.seamlessLoop&&n.main.each(function(){return a==e(this).data("switchable-clone-from")?(e(this).replaceWith(i.clone()),!1):void 0}),s.callback.call(n,t,o,i)}n.last=t}},s.prototype.switchType=function(t){var n=this,s=n.options;switch(s.type){case"tab":n.tab(t);break;case"focus":n.focus(t);break;case"slider":n.slider(t);break;case"imgscroll":n.imgscroll(t);break;default:e.error("选择类型有误")}},s.prototype.switchDefault=function(e){var t=this;t.main.hide(),t.main.eq(e).show()},s.prototype.tab=function(e){var t=this,n=t.options;if(n.hasSetup||t.switchDefault(e),n.hasArrow){var s=n.arrowClass,a=t.nav.eq(e).outerWidth(!0)*e;if(t.isInit){var i=t.nav.parent().parent();i.prepend('<div class="'+s+'"><b></b></div>').css({position:"relative"}),t.el.find("."+s).css({left:a}),t.isPlayLock=!1}else setTimeout(function(){t.isPlayLock=!1},n.speed),t.el.find("."+s).stop(!0).animate({left:a},n.speed,n.easing)}t.isInit=!1},s.prototype.focus=function(t){var n=this,s=n.options;n.isInit?(n.main.parent().css({position:"relative"}),n.main.css({position:"absolute",zIndex:0,opacity:0}).show(),n.main.eq(t).css({zIndex:1,opacity:1}),n.isPlayLock=!1):(setTimeout(function(){n.isPlayLock=!1},s.speed),n.main.eq(n.last).css({zIndex:0}).stop(!0).animate({opacity:1},s.speed,s.easing,function(){e(this).css("opacity",0)})),n.main.eq(t).css({zIndex:1}).stop(!0).animate({opacity:1},s.speed,s.easing),n.isInit=!1},s.prototype.slider=function(e){var t=this,n=t.options,s=t.mainWidth,a=t.mainHeight,i=t.content,o=s*e,l=a*e;t.isInit?("left"==n.direction?(t.main.css({"float":"left"}),i.css(n.seamlessLoop?{width:s*(t.len+2*t.cloneCount)}:{width:s*t.len}),i.css({left:-o})):"top"==n.direction&&i.css({top:-l}),i.parent().css({position:"relative"}),i.css({position:"absolute"}),t.isInit=!1,t.isPlayLock=!1):(setTimeout(function(){t.isPlayLock=!1},n.speed),"left"==n.direction?i.stop(!0).animate({left:-o},n.speed,n.easing):"top"==n.direction&&i.stop(!0).animate({top:-l},n.speed,n.easing))},s.prototype.imgscroll=function(t){var n=this,s=n.options,a=n.mainWidth,i=n.el.find("."+s.imgscrollClass);if(n.isInit){n.content.css({position:"absolute",width:a*n.len}),n.main.css({"float":"left"});var o=s.mainSelectedClass;if(n.main.eq(0).addClass(o),!i.attr("src")){var l=n.el.find("."+s.imgscrollItemClass).eq(0).attr(s.imgscrollDataSrc);i.attr("src",l)}n.main.bind(s.event,function(){var t=e(this),a=t.find("."+s.imgscrollItemClass).attr(s.imgscrollDataSrc);n.main.removeClass(o),t.addClass(o),i.attr("src",a)}),n.isInit=!1,n.isPlayLock=!1}else{setTimeout(function(){n.isPlayLock=!1},s.speed);var c=n.current*a;n.content.stop(!0).animate({left:-c},s.speed)}},s.prototype.page=function(){var e=this,t=e.options,n=e.el.find("."+t.prevClass),s=e.el.find("."+t.nextClass);n.on("click",function(t){e.isPlayLock&&e.content&&e.content.length>0||(e.isPlayLock=!0,e.prev(),t.stopPropagation())}),s.on("click",function(t){e.isPlayLock&&e.content&&e.content.length>0||(e.isPlayLock=!0,e.next(),t.stopPropagation())})},s.prototype.next=function(){var t=this,n=t.options;t.current=t.current+n.step,t.offsetIndex();var s=0;!n.seamlessLoop&&(s=-n.visible+n.step),t.current>=t.len+s&&(t.current=0);var a=n.visible;!n.seamlessLoop&&t.current+a>t.len&&(t.current=t.len>a?t.len-a:0);var i=n.seamlessLoop?t.current+t.cloneCount:t.current;t.switchTo(t.current,i),e.isFunction(n.onNext)&&n.onNext.call(t)},s.prototype.prev=function(){var t=this,n=t.options;n.seamlessLoop?t.offsetIndex(!0):(t.current-=n.step,t.current<0&&(t.current=t.current>-n.step?0:t.len-n.visible));var s=n.seamlessLoop?t.current+t.cloneCount:t.current;t.switchTo(t.current,s),e.isFunction(n.onPrev)&&n.onPrev.call(t)},s.prototype.offsetIndex=function(e){var t=this,n=t.content,s=t.options,a=t.mainWidth,i=t.mainHeight,o=null,l=null,c=null;e&&s.seamlessLoop?(c=t.current,t.current<=0?(c=t.len-s.step+t.current,o=-((t.len+(t.cloneCount+t.current))*a),l=-((t.len+(t.cloneCount+t.current))*i)):c-=s.step,t.current=c):t.current>=t.len&&s.seamlessLoop&&(c=t.current-t.len,o=-((c+t.cloneCount-s.step)*a),l=-((c+t.cloneCount-s.step)*i),t.current=c),null!=o&&"left"==s.direction?n.css({left:o}):null!=l&&"top"==s.direction&&n.css({top:l})},s.prototype.autoPlay=function(){var e=this;e.options.isAutoPlay&&e.startPlay()},s.prototype.startPlay=function(){var e=this,t=e.options;e.stopPlay(),e.autoInterval=setInterval(function(){e.main.length<=t.step?e.stopPlay():"prev"==t.playDirection?e.prev():e.next()},t.stayTime)},s.prototype.stopPlay=function(){var e=this;clearInterval(e.autoInterval)},s.prototype.iframefnc=function(e){var t=this,n=t.options,s=t.main.eq(e),a=t.nav.eq(n.seamlessLoop?e-t.cloneCount:e),i=a.attr(n.navIframe);if(i){var o=document.createElement("iframe");o.src=i,o.border=0,o.frameborder="no",o.marginwidth=0,o.marginheight=0,s.html(o),a.removeAttr(n.navIframe)}},e.fn.switchable=n,e.fn.switchable.Constructor=s}(jQuery);